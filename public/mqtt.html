<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Sincronizaciones</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f5f7fa;
        margin: 0;
        padding: 40px 0;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        gap: 40px;
        flex-wrap: wrap;
      }

      .container {
        background-color: #fff;
        padding: 30px 40px;
        border-radius: 10px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        width: 350px;
      }

      h2 {
        text-align: center;
        margin-bottom: 25px;
        color: #333;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #555;
      }

      input[type='number'],
      input[type='text'] {
        width: 100%;
        padding: 8px 10px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 14px;
      }

      button {
        width: 100%;
        background-color: #007bff;
        color: white;
        padding: 10px;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      button:disabled {
        background-color: #7aa7e9;
        cursor: not-allowed;
      }

      button:hover:not(:disabled) {
        background-color: #0056b3;
      }

      #tiendas {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 15px;
      }

      #tiendas label {
        display: flex;
        align-items: center;
        font-weight: normal;
        color: #333;
      }

      #tiendas input[type='checkbox'] {
        margin-right: 10px;
        transform: scale(1.2);
        accent-color: #007bff;
      }

      .resultado {
        margin-top: 15px;
        font-size: 13px;
        background: #f1f3f6;
        border-radius: 5px;
        padding: 8px;
        color: #333;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <!-- Factura Intercompany -->
    <div class="container">
      <h2>Sincronizar Factura Intercompany</h2>

      <label for="dia">Día:</label>
      <input type="number" id="dia" min="1" max="31" required />

      <label for="mes">Mes:</label>
      <input type="number" id="mes" min="1" max="12" required />

      <label for="companyID">Company ID:</label>
      <input type="text" id="companyID" required />

      <label for="entorno">Entorno:</label>
      <input type="text" id="entorno" required />

      <button id="btnIntercompany" onclick="enviarIntercompany()">Enviar</button>
      <div id="resultadoIntercompany" class="resultado"></div>
    </div>

    <!-- Ventas y Cierres (Filapeña)-->
    <div class="container">
      <h2>Sincronizar Ventas y Cierres (Filapeña)</h2>

      <label for="diaInicio">Día inicio:</label>
      <input type="number" id="diaInicio" min="1" max="31" required />

      <label for="diaFin">Día fin:</label>
      <input type="number" id="diaFin" min="1" max="31" required />

      <label for="mes2">Mes:</label>
      <input type="number" id="mes2" min="1" max="12" required />

      <label for="turno">Turno (0: Todo el día, 1: Mañana, 2: Tarde):</label>
      <input type="number" id="turno" min="0" max="2" required />

      <label>Tiendas:</label>
      <div id="tiendas">
        <label><input type="checkbox" id="seleccionarTodas" /> Seleccionar todas</label>
        <label><input type="checkbox" id="tienda1" value="115" /> T--101</label>
        <label><input type="checkbox" id="tienda2" value="764" /> T--076</label>
        <label><input type="checkbox" id="tienda3" value="864" /> T--152</label>
        <label><input type="checkbox" id="tienda4" value="960" /> T--210</label>
      </div>

      <label for="companyID2">Company ID:</label>
      <input type="text" id="companyID2" required />

      <label for="entornoVC">Entorno:</label>
      <input type="text" id="entornoVC" required />

      <button id="btnVentas" onclick="enviarVentasCierres()">Enviar</button>
      <div id="resultadoVentas" class="resultado"></div>
    </div>
    <!-- Ventas y Cierres (Ime Mil)-->
    <div class="container">
      <h2>Sincronizar Ventas y Cierres (Ime Mil)</h2>

      <label for="diaInicio1">Día inicio:</label>
      <input type="number" id="diaInicio1" min="1" max="31" required />

      <label for="diaFin1">Día fin:</label>
      <input type="number" id="diaFin1" min="1" max="31" required />

      <label for="mes3">Mes:</label>
      <input type="number" id="mes3" min="1" max="12" required />

      <label for="turno1">Turno (0: Todo el día, 1: Mañana, 2: Tarde):</label>
      <input type="number" id="turno1" min="0" max="2" required />

      <label for="companyID3">Company ID:</label>
      <input type="text" id="companyID3" required />

      <label for="entornoVCI">Entorno:</label>
      <input type="text" id="entornoVCI" required />

      <button id="btnVentasImeMil" onclick="enviarVentasCierresImeMil()">Enviar</button>
      <div id="resultadoVentasImeMil" class="resultado"></div>
    </div>

    <script>
      async function enviarIntercompany() {
        const dia = document.getElementById('dia').value.padStart(2, '0');
        const mes = document.getElementById('mes').value.padStart(2, '0');
        const companyID = document.getElementById('companyID').value.trim();
        const entorno = document.getElementById('entorno').value.trim();
        const boton = document.getElementById('btnIntercompany');
        const resultadoDiv = document.getElementById('resultadoIntercompany');

        if (!dia || !mes || !companyID || !entorno) {
          resultadoDiv.textContent = '⚠️ Debes completar todos los campos.';
          return;
        }

        const url = `http://omniserver.nubehit.com:3333/syncIntercompanySilemaByDate?companyID=${companyID}&day=${dia}&month=${mes}&entorno=${entorno}`;

        try {
          boton.disabled = true;
          boton.textContent = 'Enviando...';
          resultadoDiv.textContent = 'Procesando...';

          const response = await fetch(url);
          const text = await response.text();
          resultadoDiv.textContent = `${text}`;
        } catch (error) {
          resultadoDiv.textContent = '❌ Error: ' + error.message;
        } finally {
          boton.disabled = false;
          boton.textContent = 'Enviar';
        }
      }

      async function enviarVentasCierres() {
        const diaInicio = document.getElementById('diaInicio').value.padStart(2, '0');
        const diaFin = document.getElementById('diaFin').value.padStart(2, '0');
        const mes = document.getElementById('mes2').value.padStart(2, '0');
        const turno = document.getElementById('turno').value;
        const tiendas = Array.from(document.querySelectorAll('#tiendas input[type="checkbox"]:checked'))
          .filter((cb) => cb.id !== 'seleccionarTodas')
          .map((cb) => cb.value)
          .join(',');
        const companyID2 = document.getElementById('companyID2').value.trim();
        const entorno = document.getElementById('entornoVC').value.trim();
        const boton = document.getElementById('btnVentas');
        const resultadoDiv = document.getElementById('resultadoVentas');

        if (!diaInicio || !diaFin || !mes || !companyID2 || !entorno) {
          resultadoDiv.textContent = '⚠️ Debes completar todos los campos.';
          return;
        }

        const url = `http://omniserver.nubehit.com:3333/syncSilemaDate?diaInicio=${diaInicio}&diaFin=${diaFin}&mes=${mes}&turno=${turno}&tiendas=${tiendas}&companyID=${companyID2}&entorno=${entorno}&empresa=filapena`;

        try {
          boton.disabled = true;
          boton.textContent = 'Enviando...';
          resultadoDiv.textContent = 'Procesando...';

          const response = await fetch(url);
          const text = await response.text();
          resultadoDiv.textContent = `${text}`;
        } catch (error) {
          resultadoDiv.textContent = '❌ Error: ' + error.message;
        } finally {
          boton.disabled = false;
          boton.textContent = 'Enviar';
        }
      }

      async function enviarVentasCierresImeMil() {
        const diaInicio = document.getElementById('diaInicio1').value.padStart(2, '0');
        const diaFin = document.getElementById('diaFin1').value.padStart(2, '0');
        const mes = document.getElementById('mes3').value.padStart(2, '0');
        const turno = document.getElementById('turno1').value;
        const companyID3 = document.getElementById('companyID3').value.trim();
        const entorno = document.getElementById('entornoVCI').value.trim();
        const boton = document.getElementById('btnVentasImeMil');
        const resultadoDiv = document.getElementById('resultadoVentasImeMil');

        if (!diaInicio || !diaFin || !mes || !companyID3 || !entorno) {
          resultadoDiv.textContent = '⚠️ Debes completar todos los campos.';
          return;
        }

        const url = `http://omniserver.nubehit.com:3333/syncSilemaDate?diaInicio=${diaInicio}&diaFin=${diaFin}&mes=${mes}&turno=${turno}&companyID=${companyID3}&entorno=${entorno}&empresa=imeMil`;

        try {
          boton.disabled = true;
          boton.textContent = 'Enviando...';
          resultadoDiv.textContent = 'Procesando...';

          const response = await fetch(url);
          const text = await response.text();
          resultadoDiv.textContent = `${text}`;
        } catch (error) {
          resultadoDiv.textContent = '❌ Error: ' + error.message;
        } finally {
          boton.disabled = false;
          boton.textContent = 'Enviar';
        }
      }
    </script>
  </body>
</html>
